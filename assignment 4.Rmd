---
title: "Assignment 4"
author: "Marco Palombo"
date: "5/17/2022"
output: html_document: 
    code_folding: hide
---

```{r setup, include = FALSE, message = FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)

# include packages
library(tidyverse)
library(here)
library(janitor)
```

```{r import data}
#import damages data set
damages <- read_csv(here("damages.csv")) %>% 
  #rename column damages because having it names the same thing as the dataset is super stupid
  mutate(harm = damages) %>% 
  select(-damages)

#import warming data set
warming <- read_csv(here("warming.csv"))

```

```{r question 1}
# first add a column to the dataset of damages squared because it seems lm wants that to do a quadratic fit
damages_fit <- damages %>% 
  mutate(warming2 = warming^2)

# perform fit
quad_fit <- lm(harm ~ warming + warming2 + 0, data = damages_fit)
summary(quad_fit)

quad_func <- function(warming){
  harm <- quad_fit$coefficients[1]*warming + quad_fit$coefficients[2]*warming^2
  return(harm)
}

# populate
damages_fit$harm_fit = quad_func(warming))

ggplot(data = damages_fit, aes(x = warming, y = harm))+
  geom_point(aes(x = warming, y = harm))+
  
  
```

